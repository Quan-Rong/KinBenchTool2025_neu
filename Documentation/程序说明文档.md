# KnC_Bewertung MATLAB App 程序说明文档

## 1. 程序简介

KnC_Bewertung是一个用于处理Adams多体动力学仿真结果的MATLAB应用程序。该程序专门用于分析车辆悬架系统的K&C（Kinematics & Compliance，运动学与柔顺性）特性。

### 1.1 程序用途
- 读取Adams仿真结果文件（.res格式）
- 提取K&C参数数据
- 进行数据分析和计算
- 生成可视化图表
- 计算关键性能指标

### 1.2 适用对象
- 车辆悬架系统工程师
- 底盘调校工程师
- 仿真分析工程师

## 2. 文件结构说明

### 2.1 主程序文件
```
KnC_Bewertung_alpha20250127.mlapp          # MATLAB App Designer源文件
KnC_Bewertung_alpha20250127_exported.m     # 导出的MATLAB代码（10630行）
```

### 2.2 绘图函数文件
```
KinBenchTool_Bump_Plot.m                   # Bump测试绘图
KinBenchTool_Roll_Plot.m                   # Roll测试绘图
KinBenchTool_StaticLoad_Plot.m            # 静态载荷测试绘图
KinBenchTool_braking_extra_plot.m         # 制动力测试额外绘图
```

### 2.3 辅助文件
```
countlines.pl                               # Perl脚本，用于统计文件行数（Windows系统）
```

### 2.4 资源文件
```
Gestamp_Logo.png                           # 公司Logo
Icon_plot_custerm.png                      # 自定义绘图图标
icon_to_ppt.png                            # 导出PPT图标
其他图像文件...
```

### 2.5 数据文件
```
NRAC_G023_Results/                          # Adams仿真结果文件夹
  ├── NRAC_G023_parallel_travel.res        # 轮跳测试结果
  ├── NRAC_G023_roll_angle.res             # 侧倾测试结果
  ├── NRAC_G023_Lat_static_load.res        # 侧向力测试结果
  ├── NRAC_G023_Braking_static_load.res    # 制动力测试结果
  └── NRAC_G023_Accel_static_load.res      # 加速力测试结果
```

### 2.6 其他文件
```
alt_version/                                # 历史版本文件夹
KnC_Bewertung_alpha04012025_1/             # 打包版本文件夹
其他测试文件...
```

## 3. 使用说明

### 3.1 启动程序
1. 在MATLAB中打开`KnC_Bewertung_alpha20250127.mlapp`
2. 点击"Run"按钮启动程序
3. 或直接运行导出的.m文件

### 3.2 输入车辆参数
在左侧"Parameter"标签页中输入：
- **Half Load**: 半载质量（kg）
- **Max Load**: 满载质量（kg）
- **Unsprung**: 非簧载质量（kg）
- **Wheel Base**: 轴距（mm）
- **Track Front/Rear**: 前后轮距（mm）
- **COG Height**: 重心高度（mm）
- **COG in x**: 重心X坐标（mm）
- **Roll Angle**: 侧倾角（度）
- **Tire**: 轮胎规格

### 3.3 执行分析

#### 3.3.1 Bump测试
1. 切换到"Rear Suspension" → "Bump"标签页
2. 点击"Browse"按钮选择.res文件（文件名需包含"parallel_travel"）
3. 设置拟合范围（Fitting Range）
4. 点击"GO"按钮执行分析
5. 查看结果面板中的计算值
6. 在图表Tab中查看各种图表

#### 3.3.2 Roll测试
1. 切换到"Roll Test"标签页
2. 选择包含"opposite_travel"或"roll_angle"的.res文件
3. 设置拟合范围
4. 点击"GO"执行分析

#### 3.3.3 静态载荷测试
1. 切换到对应的标签页（Lateral/Braking/Accel）
2. 选择对应的.res文件
3. 设置拟合范围
4. 点击"GO"执行分析

### 3.4 查看结果
- **数值结果**: 在右侧"Results"面板中查看
- **图表**: 在对应的图表Tab中查看
- **对比**: 使用"to Compare"Spinner设置对比曲线数量

### 3.5 自定义设置
- **曲线颜色**: 使用"Curve"颜色选择器
- **拟合线颜色**: 使用"Fitting"颜色选择器
- **清空图表**: 点击"Clear Axes"按钮

## 4. 输入文件格式要求

### 4.1 .res文件格式
- 文件必须包含quasiStatic分析结果
- 文件末尾必须包含参数ID定义
- 数据格式必须符合Adams输出格式

### 4.2 文件名要求
- **Bump测试**: 文件名需包含"parallel_travel"
- **Roll测试**: 文件名需包含"opposite_travel"或"roll_angle"
- **侧向力测试**: 文件名需包含"static_load"，且数据中包含侧向力
- **制动力测试**: 文件名需包含"static_load"，且数据中包含制动力
- **加速力测试**: 文件名需包含"static_load"，且数据中包含加速力

## 5. 输出说明

### 5.1 数值输出
各项测试会计算并显示以下指标：

**Bump测试**:
- Bump Steer (deg/m)
- Bump Camber (deg/m)
- Wheel Rate (N/mm)
- Wheel Recession (mm/m)
- Track Change (mm/m)
- Spring Angle (deg)
- SVSA Angle (deg)
- SVSA Length (mm)
- Wheel Rate @ WC (N/mm)
- Suspension Frequency (Hz)
- Toe Change @ 50mm (deg)
- Wheel Travel @ 2g HL (mm)
- Wheel Rate @ 2g HL (N/mm)

**Roll测试**:
- Roll Steer (deg/deg)
- Roll Camber (deg/deg)
- Roll Camber Relative Ground (deg/deg)
- Roll Steer @ WT (deg/m)
- Roll Camber @ WT (deg/m)
- Suspension Roll Rate (Nm/deg)
- Total Roll Rate (Nm/deg)
- Roll Center Height (mm)
- Roll RCH Change (mm/deg)

**静态载荷测试**:
- Lateral/Braking/Accel Toe Compliance (deg/kN)
- Lateral/Braking/Accel Camber Compliance (deg/kN)
- Lateral/Braking/Accel Compliance (mm/kN)
- Lateral/Braking/Accel PC Compliance (mm/kN)
- Anti-dive/Anti-squat (%)

### 5.2 图表输出
每个测试工况包含多个图表：
- 左右轮对比图
- 原始数据曲线
- 线性拟合曲线
- 拟合区间标记
- 拟合公式显示
- 方向指示

## 6. 注意事项

### 6.1 文件路径
- 确保.res文件路径正确
- 避免路径中包含中文字符
- Windows系统需要Perl支持（用于统计文件行数）

### 6.2 数据质量
- 确保.res文件完整
- 确保数据包含所需参数
- 确保数据格式正确

### 6.3 参数设置
- 拟合范围应根据实际数据范围设置
- 车辆参数应准确输入
- 单位需注意（角度为度，长度为mm）

### 6.4 性能考虑
- 大文件读取可能需要较长时间
- 建议关闭不必要的图表Tab以提高性能

## 7. 已知问题

### 7.1 未实现功能
以下功能在UI中存在但未实现：
- 参考车辆选择
- Excel导出
- PPT导出
- 添加结果对比
- 批量处理
- 前悬架分析
- 回正力矩测试
- 自定义绘图
- 输出到Chassis Synthesis Tool

### 7.2 限制
- 仅支持后悬架分析（前悬架Tab为空）
- 仅支持特定格式的.res文件
- 不支持自定义参数ID映射
- 错误处理不完善

## 8. 技术支持

### 8.1 问题反馈
如遇到问题，请检查：
1. 文件格式是否正确
2. 文件名是否符合要求
3. 数据是否完整
4. MATLAB版本是否兼容

### 8.2 版本信息
- 当前版本: alpha20250127 (beta -03)
- MATLAB版本要求: R2019b或更高
- 操作系统: Windows/Linux/macOS

## 9. 更新日志

### Version alpha20250127
- 当前稳定版本
- 支持5种主要测试工况
- 完整的UI界面

### 历史版本
- 见`alt_version/`文件夹

## 10. 未来计划

1. 实现所有未完成功能
2. 添加前悬架分析支持
3. 优化性能和用户体验
4. 添加批量处理功能
5. 完善错误处理
6. 添加数据验证和错误提示
7. 支持更多文件格式
8. 添加导出功能
